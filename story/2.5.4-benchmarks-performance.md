# Story 2.5.4 : Benchmarks automatisés de performance

**Status:** Draft  
**Epic:** Epic 2 - Système de Simulation et Prédiction  
**Story Number:** 2.5.4

---

## Story

**As a** développeur,  
**I want** benchmarks automatisés pour valider la performance (≤ 0.33 s/jour),  
**so that** les problèmes de performance sont détectés automatiquement.

---

## Acceptance Criteria

1. Benchmarks automatisés avec `pytest-benchmark` pour valider performance ≤ 0.33 s/jour.
2. Métriques mesurées :
   - Génération jour : Temps moyen génération 1 jour
   - Golden Hour : Temps calcul (100 microzones)
   - Features : Temps calcul 18 features (20 arrondissements)
   - ML : Temps entraînement 4 modèles (50 runs)
   - Parallélisation : Speedup 49 runs parallèles vs séquentiel
3. Benchmarks exécutables via pytest.
4. Rapports de performance : Génération automatique rapports.
5. Tests : Validation performance, détection régressions.

---

## Integration Verification

IV1: Benchmarks valident performance ≤ 0.33 s/jour.  
IV2: Régressions de performance détectées automatiquement.

---

## Tasks / Subtasks

- [ ] Installer pytest-benchmark
- [ ] Créer benchmarks génération jour (≤ 0.33 s/jour)
- [ ] Créer benchmarks Golden Hour (100 microzones)
- [ ] Créer benchmarks Features (20 arrondissements)
- [ ] Créer benchmarks ML (4 modèles, 50 runs)
- [ ] Créer benchmarks parallélisation (speedup 49 runs)
- [ ] Implémenter génération rapports performance
- [ ] Tests : validation performance, détection régressions

---

## Dev Notes

### Architecture Context

- **Performance** : ≤ 0.33 s/jour (cible indicative, NFR2)
- **Benchmarks** : Automatisés pour validation continue (Architecture benchmarks.md)
- **Outils** : pytest-benchmark, cProfile, line_profiler, memory_profiler

### Source Tree

```
tests/benchmarks/
├── test_performance_generation.py
├── test_performance_golden_hour.py
├── test_performance_features.py
├── test_performance_ml.py
└── test_performance_parallel.py
```

### Dependencies

- pytest-benchmark : Framework benchmarks
- Composants : Stories 2.2.x, 2.3.x (composants à benchmarker)

### Testing Standards

- Benchmarks automatisés : Performance ≤ 0.33 s/jour
- Tests de régression : Détection régressions performance
- Framework : pytest-benchmark
- Emplacement : `tests/benchmarks/`

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 28 Jan 2026 | 1.0 | Création story | PM |
