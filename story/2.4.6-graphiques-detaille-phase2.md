# Story 2.4.6 : Graphiques détaillés par arrondissement (Phase 2)

**Status:** Draft  
**Epic:** Epic 2 - Système de Simulation et Prédiction  
**Story Number:** 2.4.6

---

## Story

**As a** utilisateur,  
**I want** voir graphiques détaillés (morts, blessés, incidence, vecteurs) au clic sur un arrondissement,  
**so that** j'analyse finement les risques par zone.

---

## Acceptance Criteria

1. Clic sur rectangle arrondissement → **fenêtre** (ou expander) avec graphiques.
2. **Contenu** : **nombre de morts**, **nombre de blessés**, **incidence** (évolution des incidents), **évolution des sommes de vecteurs** dans l'arrondissement ; **Phase 2** inclut aussi **évolution des 18 features** et **courbes par type** d'incident.
3. Intégration fluide avec le layout Streamlit (hors carte, selon specs UI).

---

## Integration Verification

IV1: Ouverture/fermeture sans erreur ; pas de régression Lancer/Stop.  
IV2: Données correspondent à l'arrondissement sélectionné.

---

## Tasks / Subtasks

- [ ] Implémenter détection clic sur rectangle arrondissement
- [ ] Implémenter fenêtre/expander avec graphiques détaillés
- [ ] Implémenter graphique nombre de morts (évolution temporelle)
- [ ] Implémenter graphique nombre de blessés (évolution temporelle)
- [ ] Implémenter graphique incidence (évolution des incidents)
- [ ] Implémenter graphique évolution sommes de vecteurs
- [ ] Implémenter graphique évolution 18 features (Phase 2)
- [ ] Implémenter courbes par type d'incident (Phase 2)
- [ ] Implémenter intégration fluide avec layout Streamlit
- [ ] Tests manuels : ouverture/fermeture, données correctes, pas de régression

---

## Dev Notes

### Architecture Context

- **Graphiques détaillés** : Phase 2 uniquement (FR21, Story 2.4.3)
- **Clic arrondissement** : Déclencheur pour afficher graphiques
- **Contenu MVP** : Morts, blessés, incidence, sommes vecteurs
- **Contenu Phase 2** : + 18 features, courbes par type
- **Intégration** : Fenêtre/expander hors carte, selon specs UI

### Source Tree

```
src/adapters/ui/
└── streamlit_app.py         # Application Streamlit (graphiques détaillés)

src/services/
└── visualization_service.py  # Service visualisation (optionnel)
```

### Dependencies

- UI Streamlit : Story 2.4.1, 2.4.3 (rectangles arrondissements)
- Données : Story 2.2.x (vecteurs, morts, blessés, features)

### Contenu graphiques

**MVP (Phase 2 inclut aussi) :**
- Nombre de morts (évolution temporelle)
- Nombre de blessés (évolution temporelle)
- Incidence (évolution des incidents)
- Évolution des sommes de vecteurs

**Phase 2 uniquement :**
- Évolution des 18 features
- Courbes par type d'incident (agressions, incendies, accidents)

### Testing Standards

- Tests manuels : Ouverture/fermeture, données correctes, pas de régression
- Tests d'intégration : Graphiques affichés correctement, données cohérentes
- Framework : Tests manuels (pas d'automatisation pour UI Streamlit en MVP)
- Emplacement : Tests manuels documentés

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 28 Jan 2026 | 1.0 | Création story | PM |
